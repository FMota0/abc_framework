// This is a skeleton starter React component generated by Plasmic.
// This file is owned by you, feel free to edit as you see fit.
import React, { useState } from "react";
import { PlasmicDashboard } from "./plasmic/abc_framework/PlasmicDashboard";

import { useSelector } from "react-redux";
import { getStudyPrograms } from "../store/programs/selectors";
import StudyProgramCard from "./StudyProgramCard";

function Dashboard() {
  // Use PlasmicDashboard to render this component as it was
  // designed in Plasmic, by activating the appropriate variants,
  // attaching the appropriate event handlers, etc.  You
  // can also install whatever React hooks you need here to manage state or
  // fetch data.
  //
  // Props you can pass into PlasmicDashboard are:
  // 1. Variants you want to activate,
  // 2. Contents for slots you want to fill,
  // 3. Overrides for any named node in the component to attach behavior and data,
  // 4. Props to set on the root node.
  //
  // By default, we are just piping all DashboardProps here, but feel free
  // to do whatever works for you.
  const [withAddStudy, setWithAddStudy] = useState(false)

  const programs = useSelector(getStudyPrograms);
  const Programs = programs.map(({ title, description, studies }) => {
    const registered = studies.length;
    return (
      <StudyProgramCard
        title={title}
        description={description}
        registered={`Estudos registrados: ${registered}`}
      />
    )
  });
  return (
    <PlasmicDashboard
      programs={Programs}
      withAddStudy={withAddStudy}
      modalWrapper={
        {
          props: {
            onClick: () => setWithAddStudy(false),
            modal: {
              props: {
                onClick: (e) => e.stopPropagation(),
              },
            }
          }
        }
      }
      actionIcon={
        {
          props: {
            onClick: () => setWithAddStudy(true),
          }
        }
      }
      />
  );
}

export default Dashboard;
